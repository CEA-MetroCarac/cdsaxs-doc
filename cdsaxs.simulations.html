<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>cdsaxs.simulations package &mdash; cdsaxs v0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Setting Up a Development Environment" href="for_developpers.html" />
    <link rel="prev" title="API reference" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            cdsaxs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="introduction.html#background">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">API reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For Developers:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="for_developpers.html">Setting Up a Development Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="for_developpers.html#project-structure">Project Structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="for_developpers.html#creating-a-new-simulation-model">Creating a New Simulation Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="for_developpers.html#testing">Testing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">cdsaxs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">API reference</a></li>
      <li class="breadcrumb-item active">cdsaxs.simulations package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/cdsaxs.simulations.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="cdsaxs-simulations-package">
<h1>cdsaxs.simulations package<a class="headerlink" href="#cdsaxs-simulations-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-cdsaxs.simulations.base">
<span id="cdsaxs-simulations-base-module"></span><h2>cdsaxs.simulations.base module<a class="headerlink" href="#module-cdsaxs.simulations.base" title="Permalink to this heading"></a></h2>
<p>This is a protocol that defines the methods that should be implemented to ensure that the Simulation class
is compatible with the fitter class.</p>
<dl class="py class">
<dt class="sig sig-object py" id="cdsaxs.simulations.base.Geometry">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cdsaxs.simulations.base.</span></span><span class="sig-name descname"><span class="pre">Geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/base.html#Geometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.base.Geometry" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<p>This is a protocol that defines the methods that should be implemented by the Geometry class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cdsaxs.simulations.base.Geometry.convert_to_dataframe">
<span class="sig-name descname"><span class="pre">convert_to_dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fitparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/base.html#Geometry.convert_to_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.base.Geometry.convert_to_dataframe" title="Permalink to this definition"></a></dt>
<dd><p>This is a obligatory method that should be implemented by the Geometry class.
It’s job is to take the arrays of fitparams and convert them into a pandas DataFrame
based on the initial guess given by the user.</p>
<p>Parameters:
fitparams (list): an array returned by the fitter that contains the population to be evaluated.</p>
<p>returns:
df (pandas.DataFrame): a DataFrame containing the fitparams in a readable format.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cdsaxs.simulations.base.Geometry.rescale_fitparams">
<span class="sig-name descname"><span class="pre">rescale_fitparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fitparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/base.html#Geometry.rescale_fitparams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.base.Geometry.rescale_fitparams" title="Permalink to this definition"></a></dt>
<dd><p>This is a obligatory method that should be implemented by the Geometry class.
The values incoming from the fitter are normalized in the range of -sigma to sigma they need to be rescaled.
so this method’s job is to take the arrays of fitparams and rescale them based on the initial guess given by the user.
the formula used should be something like this:
rescaled_fitparams = fitparams * multiplier + initial_guess
multiplier and initial_guess are the values given by the user. if you find that a certain set of multiplier works
better you can hardcode them as well but it is not recommended as it will make the code less flexible.</p>
<p>Parameters:
fitparams (list): an array returned by the fitter that contains the population to be evaluated.</p>
<p>returns:
df (dataframe): an array containing the rescaled fitparams.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cdsaxs.simulations.base.Simulation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cdsaxs.simulations.base.</span></span><span class="sig-name descname"><span class="pre">Simulation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/base.html#Simulation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.base.Simulation" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Protocol</span></code></p>
<p>This is a protocol that defines the methods that should be implemented by the Simulation class.</p>
<dl class="py property">
<dt class="sig sig-object py" id="cdsaxs.simulations.base.Simulation.geometry">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">geometry</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#cdsaxs.simulations.base.Geometry" title="cdsaxs.simulations.base.Geometry"><span class="pre">Geometry</span></a></em><a class="headerlink" href="#cdsaxs.simulations.base.Simulation.geometry" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cdsaxs.simulations.base.Simulation.set_from_fitter">
<span class="sig-name descname"><span class="pre">set_from_fitter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">from_fitter</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/base.html#Simulation.set_from_fitter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.base.Simulation.set_from_fitter" title="Permalink to this definition"></a></dt>
<dd><p>This is a obligatory method that should be implemented by the Simulation class.
It should tell the Simulation object that the incoming data is from a fitter object and it should also initialize necessary things
like saving the initial guess given by user to a dataframe.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cdsaxs.simulations.base.Simulation.simulate_diffraction">
<span class="sig-name descname"><span class="pre">simulate_diffraction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fitparams</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/base.html#Simulation.simulate_diffraction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.base.Simulation.simulate_diffraction" title="Permalink to this definition"></a></dt>
<dd><p>This is a obligatory method that should be implemented by the Simulation class. It is used by Residual class.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – _description_</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-cdsaxs.simulations.stacked_trapezoid">
<span id="cdsaxs-simulations-stacked-trapezoid-module"></span><h2>cdsaxs.simulations.stacked_trapezoid module<a class="headerlink" href="#module-cdsaxs.simulations.stacked_trapezoid" title="Permalink to this heading"></a></h2>
<p>This module simulates the diffraction pattern of a stacked trapezoids model.</p>
<p>It is built upon the protocol defined in base.py.</p>
<dl class="simple">
<dt>Classes:</dt><dd><p>StackedTrapezoidSimulation: A class representing a simulation of stacked trapezoids for diffraction pattern calculation.
StackedTrapezoidGeometry: A class representing the geometry of stacked trapezoids for simulations.
StackedTrapezoidDiffraction: A class for simulating diffraction from stacked trapezoids.</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidDiffraction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cdsaxs.simulations.stacked_trapezoid.</span></span><span class="sig-name descname"><span class="pre">StackedTrapezoidDiffraction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TrapezoidGeometry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xp=&lt;module</span> <span class="pre">'numpy'</span> <span class="pre">from</span> <span class="pre">'/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/numpy/__init__.py'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/stacked_trapezoid.html#StackedTrapezoidDiffraction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidDiffraction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for simulating diffraction from stacked trapezoids.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidDiffraction.calculate_coefficients">
<span class="sig-name descname"><span class="pre">calculate_coefficients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qzs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/stacked_trapezoid.html#StackedTrapezoidDiffraction.calculate_coefficients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidDiffraction.calculate_coefficients" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the coefficients needed to simulate intensities, taking into account the material through the weight parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qzs</strong> – array-like
List of qz values.</p></li>
<li><p><strong>df</strong> – DataFrame containing the parameters for the trapezoids.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>array-like</dt><dd><p>Coefficients needed to calculate the form factor.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>coefficients</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidDiffraction.calculate_form_factor">
<span class="sig-name descname"><span class="pre">calculate_form_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qzs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/stacked_trapezoid.html#StackedTrapezoidDiffraction.calculate_form_factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidDiffraction.calculate_form_factor" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the form factor of the stacked trapezoid at all qx, qz positions.</p>
<p>Arguments:
qys, qzs: array_like</p>
<blockquote>
<div><p>List of qx/qz at which the form factor is simulated.</p>
</div></blockquote>
<p>df: DataFrame containing the parameters for the trapezoids.</p>
<p>Returns:
form_factor: array_like</p>
<blockquote>
<div><p>Values of the form factor.</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidDiffraction.correct_form_factor_intensity">
<span class="sig-name descname"><span class="pre">correct_form_factor_intensity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qzs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/stacked_trapezoid.html#StackedTrapezoidDiffraction.correct_form_factor_intensity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidDiffraction.correct_form_factor_intensity" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the intensites using form factor and apply debye waller corrections</p>
<p>Arguments:
qys, qzs: array_like</p>
<blockquote>
<div><p>List of qx/qz at which the form factor is simulated.</p>
</div></blockquote>
<dl class="simple">
<dt>fitparams: array_like, optional</dt><dd><p>parameters returned by fitter.</p>
</dd>
<dt>fit_mode: str, optional</dt><dd><p>Method used for fitting. Default is ‘cmaes’.</p>
</dd>
<dt>best_fit: array_like, optional</dt><dd><p>Best fit obtained from fitter.</p>
</dd>
</dl>
<p>Returns:
corrected_intensity: array_like</p>
<blockquote>
<div><p>Corrected form factor intensity.</p>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidDiffraction.corrections_dwi0bk">
<span class="sig-name descname"><span class="pre">corrections_dwi0bk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">intensities</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qzs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/stacked_trapezoid.html#StackedTrapezoidDiffraction.corrections_dwi0bk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidDiffraction.corrections_dwi0bk" title="Permalink to this definition"></a></dt>
<dd><p>Apply corrections to the form factor intensities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> – DataFrame containing the parameters for the trapezoids.</p></li>
<li><p><strong>qxs</strong> – array-like
List of qx/qz at which the form factor is simulated.</p></li>
<li><p><strong>qzs</strong> – array-like
List of qx/qz at which the form factor is simulated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>array-like</dt><dd><p>Corrected form factor intensities.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>intensities_corr</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidDiffraction.trapezoid_form_factor">
<span class="sig-name descname"><span class="pre">trapezoid_form_factor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qzs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/stacked_trapezoid.html#StackedTrapezoidDiffraction.trapezoid_form_factor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidDiffraction.trapezoid_form_factor" title="Permalink to this definition"></a></dt>
<dd><p>Simulation of the form factor of a trapezoid at all qx, qz positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qys</strong> – array-like
List of qy/qz at which the form factor is simulated.</p></li>
<li><p><strong>qzs</strong> – array-like
List of qy/qz at which the form factor is simulated.</p></li>
<li><p><strong>y1</strong> – array-like
Values of the bottom right and left position of the trapezoids.</p></li>
<li><p><strong>y2</strong> – array-like
Values of the bottom right and left position of the trapezoids.</p></li>
<li><p><strong>df</strong> – DataFrame containing the parameters for the trapezoids.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>array-like</dt><dd><p>Values of the form factor.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>form_factor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cdsaxs.simulations.stacked_trapezoid.</span></span><span class="sig-name descname"><span class="pre">StackedTrapezoidGeometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xp=&lt;module</span> <span class="pre">'numpy'</span> <span class="pre">from</span> <span class="pre">'/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/numpy/__init__.py'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_fitter=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_guess=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/stacked_trapezoid.html#StackedTrapezoidGeometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#cdsaxs.simulations.base.Geometry" title="cdsaxs.simulations.base.Geometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">Geometry</span></code></a></p>
<p>A class representing the geometry of stacked trapezoids for simulations.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry.xp">
<span class="sig-name descname"><span class="pre">xp</span></span><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry.xp" title="Permalink to this definition"></a></dt>
<dd><p>The numpy-like module to use for array operations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry.from_fitter">
<span class="sig-name descname"><span class="pre">from_fitter</span></span><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry.from_fitter" title="Permalink to this definition"></a></dt>
<dd><p>Flag indicating whether the geometry is created from a fitter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry.initial_guess">
<span class="sig-name descname"><span class="pre">initial_guess</span></span><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry.initial_guess" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary containing the initial guess values for the geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry.initial_guess_dataframe">
<span class="sig-name descname"><span class="pre">initial_guess_dataframe</span></span><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry.initial_guess_dataframe" title="Permalink to this definition"></a></dt>
<dd><p>DataFrame containing the initial guess values for the geometry.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry.symmetric">
<span class="sig-name descname"><span class="pre">symmetric</span></span><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry.symmetric" title="Permalink to this definition"></a></dt>
<dd><p>Flag indicating whether the trapezoids are symmetric.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry.calculate_ycoords">
<span class="sig-name descname"><span class="pre">calculate_ycoords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">langle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rangle</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/stacked_trapezoid.html#StackedTrapezoidGeometry.calculate_ycoords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry.calculate_ycoords" title="Permalink to this definition"></a></dt>
<dd><p>Calculate y1 and y2 coordinates for each trapezoid.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry.calculate_shift">
<span class="sig-name descname"><span class="pre">calculate_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">height</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">langle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/stacked_trapezoid.html#StackedTrapezoidGeometry.calculate_shift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry.calculate_shift" title="Permalink to this definition"></a></dt>
<dd><p>Calculate how much the trapezoids are shifted in the z direction.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry.convert_to_dataframe">
<span class="sig-name descname"><span class="pre">convert_to_dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fitparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/stacked_trapezoid.html#StackedTrapezoidGeometry.convert_to_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry.convert_to_dataframe" title="Permalink to this definition"></a></dt>
<dd><p>Convert the fitparams to a DataFrame based on the initial guess DataFrame.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry.rescale_fitparams">
<span class="sig-name descname"><span class="pre">rescale_fitparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fitparams_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/stacked_trapezoid.html#StackedTrapezoidGeometry.rescale_fitparams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry.rescale_fitparams" title="Permalink to this definition"></a></dt>
<dd><p>Rescale the Gaussian distributed values obtained from the fitter to the actual values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry.check_physical_validity">
<span class="sig-name descname"><span class="pre">check_physical_validity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rescaled_fitparams_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/stacked_trapezoid.html#StackedTrapezoidGeometry.check_physical_validity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry.check_physical_validity" title="Permalink to this definition"></a></dt>
<dd><p>Check if the values obtained from the fitter make physical sense.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">calculate_shift</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/stacked_trapezoid.html#StackedTrapezoidGeometry.calculate_shift"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Permalink to this definition"></a></dt>
<dd><p>Calculate how much the trapezoids are shifted in the z direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pd.dataframe</em>) – DataFrame containing the parameters for the trapezoids.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of calculated shift values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>shift (ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">calculate_ycoords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/stacked_trapezoid.html#StackedTrapezoidGeometry.calculate_ycoords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id1" title="Permalink to this definition"></a></dt>
<dd><p>Calculate y1 and y2 coordinates for each trapezoid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pd.dataframe</em>) – DataFrame containing the parameters for the trapezoids.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple of 2D arrays of y1 and y2 values.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(y1 (ndarray), y2 (ndarray))</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">check_physical_validity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rescaled_fitparams_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/stacked_trapezoid.html#StackedTrapezoidGeometry.check_physical_validity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id2" title="Permalink to this definition"></a></dt>
<dd><p>Check if the values obtained from the fitter make physical sense.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rescaled_fitparams_df</strong> (<em>pd.dataframe</em>) – DataFrame containing the rescaled values of the fitparams.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame containing the rescaled values of the fitparams with the values that do not make physical sense replaced by np.nan.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>rescaled_df (pd.dataframe)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">convert_to_dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fitparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/stacked_trapezoid.html#StackedTrapezoidGeometry.convert_to_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id3" title="Permalink to this definition"></a></dt>
<dd><p>Convert the fitparams to a DataFrame based on the initial guess dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fitparams</strong> (<em>dictionary</em>) – Array-like containing the Arguments for the trapezoids.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame containing the Arguments for the trapezoids.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd_fitparams (dictionary)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">rescale_fitparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fitparams_df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/stacked_trapezoid.html#StackedTrapezoidGeometry.rescale_fitparams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id4" title="Permalink to this definition"></a></dt>
<dd><p>Rescale the Gaussian distributed values obtained from the fitter to the actual values and check if the values make physical sense.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>fitparams_df</strong> (<em>pd.dataframe</em>) – DataFrame containing the parameters for the trapezoids.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame containing the rescaled values of the fitparams.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>rescaled_fitparams_df (pd.dataframe)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry.set_initial_guess_dataframe">
<span class="sig-name descname"><span class="pre">set_initial_guess_dataframe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">best_fit_cmaes_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/stacked_trapezoid.html#StackedTrapezoidGeometry.set_initial_guess_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry.set_initial_guess_dataframe" title="Permalink to this definition"></a></dt>
<dd><p>Set the initial guess values in a dataframe and put them in the attribute initial_guess_dataframe.
If the fitter is MCMC, replace the initial guess values with the best estimate obtained from CMAES.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>best_fit_cmaes_df</strong> (<em>DataFrame</em><em>, </em><em>optional</em>) – The best fit Arguments obtained from the CMAES to be used by MCMC.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidSimulation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cdsaxs.simulations.stacked_trapezoid.</span></span><span class="sig-name descname"><span class="pre">StackedTrapezoidSimulation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qzs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_fitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/stacked_trapezoid.html#StackedTrapezoidSimulation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidSimulation" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#cdsaxs.simulations.base.Simulation" title="cdsaxs.simulations.base.Simulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">Simulation</span></code></a></p>
<p>A class representing a simulation of stacked trapezoids for diffraction pattern calculation.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidSimulation.qys">
<span class="sig-name descname"><span class="pre">qys</span></span><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidSimulation.qys" title="Permalink to this definition"></a></dt>
<dd><p>The q-values in the y-direction for diffraction calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidSimulation.qzs">
<span class="sig-name descname"><span class="pre">qzs</span></span><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidSimulation.qzs" title="Permalink to this definition"></a></dt>
<dd><p>The q-values in the z-direction for diffraction calculation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>array-like</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidSimulation.xp">
<span class="sig-name descname"><span class="pre">xp</span></span><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidSimulation.xp" title="Permalink to this definition"></a></dt>
<dd><p>The module used for numerical computations (numpy or cupy).</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>module</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidSimulation.from_fitter">
<span class="sig-name descname"><span class="pre">from_fitter</span></span><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidSimulation.from_fitter" title="Permalink to this definition"></a></dt>
<dd><p>Indicates if the simulation is called from the fitter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidSimulation.TrapezoidGeometry">
<span class="sig-name descname"><span class="pre">TrapezoidGeometry</span></span><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidSimulation.TrapezoidGeometry" title="Permalink to this definition"></a></dt>
<dd><p>The geometry object for the stacked trapezoids.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry" title="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry">StackedTrapezoidGeometry</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidSimulation.TrapezoidDiffraction">
<span class="sig-name descname"><span class="pre">TrapezoidDiffraction</span></span><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidSimulation.TrapezoidDiffraction" title="Permalink to this definition"></a></dt>
<dd><p>The diffraction object for the stacked trapezoids.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference internal" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidDiffraction" title="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidDiffraction">StackedTrapezoidDiffraction</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidSimulation.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qzs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_fitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/stacked_trapezoid.html#StackedTrapezoidSimulation.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidSimulation.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initializes the StackedTrapezoidSimulation object.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidSimulation.simulate_diffraction">
<span class="sig-name descname"><span class="pre">simulate_diffraction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitparams</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cmaes'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_fit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/stacked_trapezoid.html#StackedTrapezoidSimulation.simulate_diffraction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidSimulation.simulate_diffraction" title="Permalink to this definition"></a></dt>
<dd><p>Simulates the diffraction pattern of the stacked trapezoids.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidSimulation.set_from_fitter">
<span class="sig-name descname"><span class="pre">set_from_fitter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_fitter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_fit_cmaes_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/stacked_trapezoid.html#StackedTrapezoidSimulation.set_from_fitter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidSimulation.set_from_fitter" title="Permalink to this definition"></a></dt>
<dd><p>Sets the from_fitter attribute and updates the geometry object accordingly.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidSimulation.geometry">
<span class="sig-name descname"><span class="pre">geometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidSimulation.geometry" title="Permalink to this definition"></a></dt>
<dd><p>Returns the geometry object for the stacked trapezoids.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="id5">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">geometry</span></span><a class="headerlink" href="#id5" title="Permalink to this definition"></a></dt>
<dd><p>Returns the geometry object for the stacked trapezoids.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The geometry object for the stacked trapezoids.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>TrapezoidGeometry (<a class="reference internal" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry" title="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry">StackedTrapezoidGeometry</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">set_from_fitter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">from_fitter</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">best_fit_cmaes_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/stacked_trapezoid.html#StackedTrapezoidSimulation.set_from_fitter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id6" title="Permalink to this definition"></a></dt>
<dd><p>Sets the from_fitter attribute and updates the geometry object accordingly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>from_fitter</strong> (<em>bool</em>) – Indicates if the simulation is called from the fitter.</p></li>
<li><p><strong>best_fit_cmaes_df</strong> (<em>pd.dataframe</em>) – The best fit Arguments obtained from the CMAES.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">simulate_diffraction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'cmaes'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/stacked_trapezoid.html#StackedTrapezoidSimulation.simulate_diffraction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id7" title="Permalink to this definition"></a></dt>
<dd><p>Simulates the diffraction pattern of the stacked trapezoids.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fitparams</strong> (<em>list</em><em>, </em><em>optional</em>) – A list of floats coming from the fitter. Defaults to None.</p></li>
<li><p><strong>best_fit</strong> (<em>array-like</em><em>, </em><em>optional</em>) – The best fit Arguments obtained from the fitter. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A 2D array of floats containing the corrected intensity.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>corrected_intensity (array-like)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-cdsaxs.simulations.strong_castle">
<span id="cdsaxs-simulations-strong-castle-module"></span><h2>cdsaxs.simulations.strong_castle module<a class="headerlink" href="#module-cdsaxs.simulations.strong_castle" title="Permalink to this heading"></a></h2>
<p>This module is a child class of the StackedTrapezoidSimulation class. Its purpose is to implement the
Strong Castle model which calculates the overlay.</p>
<dl class="simple">
<dt>Classes:</dt><dd><p>StrongCastleSimulation: This class is a child class of the StackedTrapezoidSimulation class.
StrongCastleGeometry: This class is a child class of the StackedTrapezoidGeometry class.
StrongCastleDiffraction: This class is a child class of the StackedTrapezoidDiffraction class.</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="cdsaxs.simulations.strong_castle.StrongCastleDiffraction">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cdsaxs.simulations.strong_castle.</span></span><span class="sig-name descname"><span class="pre">StrongCastleDiffraction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">TrapezoidGeometry</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xp=&lt;module</span> <span class="pre">'numpy'</span> <span class="pre">from</span> <span class="pre">'/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/numpy/__init__.py'&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/strong_castle.html#StrongCastleDiffraction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.strong_castle.StrongCastleDiffraction" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidDiffraction" title="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidDiffraction"><code class="xref py py-class docutils literal notranslate"><span class="pre">StackedTrapezoidDiffraction</span></code></a></p>
<p>This class is a child class of the StackedTrapezoidDiffraction class. It modifies the correct_form_factor_intensity method to account for the two
fixed params n1 and n2 which are the number of trapezoids in the first and second layer of trapezoids respectively.</p>
<dl class="py method">
<dt class="sig sig-object py" id="cdsaxs.simulations.strong_castle.StrongCastleDiffraction.correct_form_factor_intensity">
<span class="sig-name descname"><span class="pre">correct_form_factor_intensity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qzs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fitparams</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/strong_castle.html#StrongCastleDiffraction.correct_form_factor_intensity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.strong_castle.StrongCastleDiffraction.correct_form_factor_intensity" title="Permalink to this definition"></a></dt>
<dd><p>remove the fixed parameters n1 and n2 from the fitparams dictionary and call the parent class correct_form_factor_intensity method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>qys</strong> (<em>np.ndarray</em>) – points in the y direction where form factor is calculated</p></li>
<li><p><strong>qzs</strong> (<em>np.ndarray</em>) – points in the z direction where form factor is calculated</p></li>
<li><p><strong>fitparams</strong> (<em>np.ndarray</em>) – a dictionary containing the parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>intensity of the strong castle model</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>corrected_intensity (np.ndarray)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cdsaxs.simulations.strong_castle.StrongCastleGeometry">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cdsaxs.simulations.strong_castle.</span></span><span class="sig-name descname"><span class="pre">StrongCastleGeometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xp=&lt;module</span> <span class="pre">'numpy'</span> <span class="pre">from</span> <span class="pre">'/opt/hostedtoolcache/Python/3.11.9/x64/lib/python3.11/site-packages/numpy/__init__.py'&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_fitter=False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_guess=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/strong_castle.html#StrongCastleGeometry"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.strong_castle.StrongCastleGeometry" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry" title="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidGeometry"><code class="xref py py-class docutils literal notranslate"><span class="pre">StackedTrapezoidGeometry</span></code></a></p>
<p>This class is a child class of the StackedTrapezoidGeometry class. Several methods are modified and added to implement the Strong Castle model(notably the most important
calculate_ycoords).</p>
<dl class="py method">
<dt class="sig sig-object py" id="cdsaxs.simulations.strong_castle.StrongCastleGeometry.calculate_ycoords">
<span class="sig-name descname"><span class="pre">calculate_ycoords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/strong_castle.html#StrongCastleGeometry.calculate_ycoords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.strong_castle.StrongCastleGeometry.calculate_ycoords" title="Permalink to this definition"></a></dt>
<dd><p>This is the modified version of the calculate_ycoords method in the parent class. The two trapezoids are separated into two groups and the y coordinates are calculated
and the y coordinates of the second trapezoid are shifted by the overlay value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – dataframe containing the trapezoid parameters</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>y1 coordinates of the trapezoids
y2 (numpy.ndarray): y2 coordinates of the trapezoids</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>y1 (numpy.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cdsaxs.simulations.strong_castle.StrongCastleGeometry.check_initial_guess">
<span class="sig-name descname"><span class="pre">check_initial_guess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/strong_castle.html#StrongCastleGeometry.check_initial_guess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.strong_castle.StrongCastleGeometry.check_initial_guess" title="Permalink to this definition"></a></dt>
<dd><p>Check if the number of trapezoids  n1+n2 is equal to the number of angles in the initial_guess dictionary</p>
<p>Args:
initial_guess (dict): dictionary containing the initial guess for the parameters</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cdsaxs.simulations.strong_castle.StrongCastleGeometry.remove_fixed_params">
<span class="sig-name descname"><span class="pre">remove_fixed_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">initial_guess</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/strong_castle.html#StrongCastleGeometry.remove_fixed_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.strong_castle.StrongCastleGeometry.remove_fixed_params" title="Permalink to this definition"></a></dt>
<dd><p>Remove the fixed parameters which are the number of first and second layer of trapezoids n1 and n2 from the initial_guess dictionary so that they are not fitted.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>initial_guess</strong> (<em>dictionary</em>) – A dictionary containing the initial guess for the parameters provided by the user.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing the initial guess for the parameters without the fixed parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>initial_guess (dictionary)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="cdsaxs.simulations.strong_castle.StrongCastleGeometry.set_n1_n2">
<span class="sig-name descname"><span class="pre">set_n1_n2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/strong_castle.html#StrongCastleGeometry.set_n1_n2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.strong_castle.StrongCastleGeometry.set_n1_n2" title="Permalink to this definition"></a></dt>
<dd><p>Set self.n1 and self.n2 to the provided values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n1</strong> (<em>integer</em>) – number of trapezoids in first layer of trapezoids</p></li>
<li><p><strong>n2</strong> (<em>integer</em>) – number of trapezoids in second layer of trapezoids</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="cdsaxs.simulations.strong_castle.StrongCastleSimulation">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">cdsaxs.simulations.strong_castle.</span></span><span class="sig-name descname"><span class="pre">StrongCastleSimulation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">qys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">qzs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">from_fitter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_gpu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_guess</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/cdsaxs/simulations/strong_castle.html#StrongCastleSimulation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#cdsaxs.simulations.strong_castle.StrongCastleSimulation" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidSimulation" title="cdsaxs.simulations.stacked_trapezoid.StackedTrapezoidSimulation"><code class="xref py py-class docutils literal notranslate"><span class="pre">StackedTrapezoidSimulation</span></code></a></p>
<p>This class is a child class of the StackedTrapezoidSimulation class.</p>
</dd></dl>

</section>
<section id="module-cdsaxs.simulations">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-cdsaxs.simulations" title="Permalink to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="API reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="for_developpers.html" class="btn btn-neutral float-right" title="Setting Up a Development Environment" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Nischal Dhungana.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>